(function(c){var e=c.Vector3DUtil;var b=c.JMatrix3D;var d=c.JNumber3D;var a=function(f,g,h){this.Super();this._body=f;this._pointOnBody=g;this._worldPosition=h;f.addConstraint(this);};c.extend(a,c.JConstraint);a.prototype.minVelForProcessing=0.001;a.prototype.allowedDeviation=0.01;a.prototype.timescale=4;a.prototype._body=null;a.prototype._pointOnBody=null;a.prototype._worldPosition=null;a.prototype.set_worldPosition=function(f){this._worldPosition=f;};a.prototype.get_worldPosition=function(){return this._worldPosition;};a.prototype.apply=function(f){this.set_satisfied(true);var k=this._pointOnBody.slice(0);b.multiplyVector(this._body.get_currentState().get_orientation(),k);k=e.add(k,this._body.get_currentState().position);var m=e.subtract(k,this._body.get_currentState().position);var q=e.add(this._body.get_currentState().linVelocity,e.crossProduct(this._body.get_currentState().rotVelocity,m));var g;var p;var j=e.subtract(k,this._worldPosition);var r=e.get_length(j);if(r>this.allowedDeviation){p=d.getDivideVector(j,r);g=d.getScaleVector(p,(this.allowedDeviation-r)/(this.timescale*f));}else{g=[0,0,0,0];}var o=e.subtract(q,g);var l=e.get_length(o);if(l<this.minVelForProcessing){return false;}o=d.getDivideVector(o,l);var n=e.crossProduct(m,o);b.multiplyVector(this._body.get_worldInvInertia(),n);var i=this._body.get_invMass()+e.dotProduct(o,e.crossProduct(n,m));if(i<d.NUM_TINY){return false;}var h=-l/i;this._body.applyWorldImpulse(d.getScaleVector(o,h),k);this._body.setConstraintsAndCollisionsUnsatisfied();this.set_satisfied(true);return true;};c.JConstraintWorldPoint=a;})(jigLib);