(function(d){var j=d.Vector3DUtil;var e=d.JMatrix3D;var a=d.JNumber3D;var h=d.JConstraint;var f=d.JConfig;var g=d.JSphere;var b=d.MaterialProperties;var i=d.CollPointInfo;var k=d.CollisionInfo;var c=function(){this.name="SphereSphere";this.type0="SPHERE";this.type1="SPHERE";};d.extend(c,d.CollDetectFunctor);c.prototype.collDetect=function(r,x){var m=r.body0;var A=r.body1;var n=j.subtract(m.get_oldState().position,A.get_oldState().position);var p=j.subtract(m.get_currentState().position,A.get_currentState().position);var z=j.get_lengthSquared(n);var o=j.get_lengthSquared(p);var l=m.get_radius()+A.get_radius();if(Math.min(z,o)<Math.pow(l+f.collToll,2)){var w=Math.sqrt(z);var u=l-w;if(w>a.NUM_TINY){n=a.getDivideVector(n,w);}else{n=j.Y_AXIS;e.multiplyVector(e.getRotationMatrix(0,0,1,360*Math.random()),n);}var t=j.add(A.get_oldState().position,a.getScaleVector(n,A.get_radius()-0.5*u));var s=[];var q=new i();q.r0=j.subtract(t,m.get_oldState().position);q.r1=j.subtract(t,A.get_oldState().position);q.initialPenetration=u;s.push(q);var v=new k();v.objInfo=r;v.dirToBody=n;v.pointInfo=s;var y=new b();y.set_restitution(Math.sqrt(m.get_material().get_restitution()*A.get_material().get_restitution()));y.set_friction(Math.sqrt(m.get_material().get_friction()*A.get_material().get_friction()));v.mat=y;x.push(v);r.body0.collisions.push(v);r.body1.collisions.push(v);}};d.CollDetectSphereSphere=c;})(jigLib);