(function(e){var i=e.Vector3DUtil;var a=e.JNumber3D;var g=e.JConstraint;var f=e.JConfig;var b=e.JPlane;var k=e.JSegment;var d=e.JBox;var c=e.MaterialProperties;var l=e.RigidBody;var h=e.CollPointInfo;var j=e.CollisionInfo;var m=function(){this.name="BoxPlane";this.type0="BOX";this.type1="PLANE";};e.extend(m,e.CollDetectFunctor);m.prototype.collDetect=function(q,A){var v;if(q.body0.get_type()=="PLANE"){v=q.body0;q.body0=q.body1;q.body1=v;}var t=q.body0;var u=q.body1;var B=u.pointPlaneDistance(t.get_currentState().position);if(B>t.get_boundingSphere()+f.collToll){return;}var D=t.getCornerPoints(t.get_currentState());var w=t.getCornerPoints(t.get_oldState());var r=[];var p;var o;var n;var z;var x;for(var s=0;s<8;s++){o=D[s];n=w[s];z=-1*u.pointPlaneDistance(o);x=-1*u.pointPlaneDistance(n);if(Math.max(z,x)>-f.collToll){p=new h();p.r0=i.subtract(n,t.get_oldState().position);p.r1=i.subtract(n,u.get_oldState().position);p.initialPenetration=x;r.push(p);}}if(r.length>0){var y=new j();y.objInfo=q;y.dirToBody=u.get_normal();y.pointInfo=r;var C=new c();C.set_restitution(Math.sqrt(t.get_material().get_restitution()*u.get_material().get_restitution()));C.set_friction(Math.sqrt(t.get_material().get_friction()*u.get_material().get_friction()));y.mat=C;A.push(y);q.body0.collisions.push(y);q.body1.collisions.push(y);}};e.CollDetectBoxPlane=m;})(jigLib);